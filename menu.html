<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Menu</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

  <!-- Snipcart CSS -->
  <link href="https://cdn.snipcart.com/themes/v3.4.1/default/snipcart.css" rel="stylesheet" />
  
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
    h1 { text-align: center; }
    .products { display: flex; flex-wrap: wrap; justify-content: space-between; }
    .product { width: 48%; border: 1px solid #ccc; border-radius: 8px; margin-bottom: 1rem; padding: 0.5rem; box-sizing: border-box; }
    .product img { width: 100%; height: auto; border-radius: 6px; }
    .product-details { padding: 0.5rem 0; }
    .product-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 0.3rem; }
    .product-desc { font-size: 0.9rem; margin-bottom: 0.3rem; }
    .product-price { font-weight: bold; margin-bottom: 0.5rem; }
    button.add-to-cart {
      background: #2d89ef; color: white; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>Delivery Menu</h1>
  <div class="products" id="products"></div>

  <!-- Snipcart container -->
  <div hidden id="snipcart" data-api-key="YOUR_SNIPCART_API_KEY"></div>

  <!-- Snipcart JS -->
  <script src="https://cdn.snipcart.com/themes/v3.4.1/default/snipcart.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_FIREBASE_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Redirect to login if not authenticated
    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = "index.html";
      }
    });

    // Google Sheet details
    const sheetId = "1En6VDJfoG0eG7JlabNspYP7Cqc3PzZVU-87kwJdZjgQ";
    const sheetName = "Sheet1"; // change if your sheet tab is named differently
    const sheetUrl = `https://opensheet.elk.sh/${sheetId}/${sheetName}`;

    // Fetch menu products from Google Sheet
    fetch(sheetUrl)
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("products");
        data.forEach(item => {
          // Required fields: Image, Name, Description, Price
          const product = document.createElement("div");
          product.className = "product";

          product.innerHTML = `
            <img src="${item.Image}" alt="${item.Name}" />
            <div class="product-details">
              <div class="product-title">${item.Name}</div>
              <div class="product-desc">${item.Description}</div>
              <div class="product-price">$${parseFloat(item.Price).toFixed(2)}</div>
              <button
                class="add-to-cart snipcart-add-item"
                data-item-id="${item.Name.replace(/\s+/g, '-')}"
                data-item-price="${item.Price}"
                data-item-url="menu.html"
                data-item-description="${item.Description}"
                data-item-image="${item.Image}"
                data-item-name="${item.Name}">
                Add to Cart
              </button>
            </div>
          `;
          container.appendChild(product);
        });
      })
      .catch(e => {
        console.error("Failed to load products:", e);
        document.getElementById("products").innerText = "Failed to load menu.";
      });
  </script>
</body>
</html>
